(function($) {
  "use strict";
  
  // Obtener el estado actual del menú del almacenamiento local
  var isSidebarToggled = localStorage.getItem("isSidebarToggled") === "true";
  
  // Función para guardar el estado del menú en el almacenamiento local
  function saveSidebarState() {
    localStorage.setItem("isSidebarToggled", $(".sidebar").hasClass("toggled"));
  }
  
  // Restaurar el estado del menú al cargar la página
  if (isSidebarToggled) {
    $("body").addClass("sidebar-toggled");
    $(".sidebar").addClass("toggled");
    $(".sidebar .collapse").collapse("hide");
  }
  
  $("#sidebarToggle, #sidebarToggleTop").on("click", function(e) {
    $("body").toggleClass("sidebar-toggled");
    $(".sidebar").toggleClass("toggled");
    $(".sidebar").hasClass("toggled") && $(".sidebar .collapse").collapse("hide");
    
    // Guardar el estado del menú en el almacenamiento local al hacer clic
    saveSidebarState();
  });
  
  $(window).resize(function() {
    if ($(window).width() < 768) {
      $(".sidebar .collapse").collapse("hide");
    }
    
    if ($(window).width() < 480 && !$(".sidebar").hasClass("toggled")) {
      $("body").addClass("sidebar-toggled");
      $(".sidebar").addClass("toggled");
      $(".sidebar .collapse").collapse("hide");
    }
  });
  
  $("body.fixed-nav .sidebar").on("mousewheel DOMMouseScroll wheel", function(e) {
    if ($(window).width() >= 768) {
      var o = (e.originalEvent || e).wheelDelta || -((e.originalEvent || e).detail);
      this.scrollTop += 30 * (o < 0 ? 1 : -1);
      e.preventDefault();
    }
  });
  
  $(document).on("scroll", function() {
    if ($(this).scrollTop() > 100) {
      $(".scroll-to-top").fadeIn();
    } else {
      $(".scroll-to-top").fadeOut();
    }
  });
  
  $(document).on("click", "a.scroll-to-top", function(e) {
    var target = $(this).attr("href");
    $("html, body").stop().animate({
      scrollTop: $(target).offset().top
    }, 1000, "easeInOutExpo");
    e.preventDefault();
  });
  
})(jQuery);
